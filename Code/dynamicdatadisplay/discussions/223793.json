[
  {
    "Id": "481307",
    "ThreadId": "223793",
    "Html": "<p>Hi,</p>\r\n<p>i'am trying to print my chart.</p>\r\n<div style=\"background-color:white;color:black\"><pre><span style=\"color:blue\">double</span> width = printDialog.PrintableAreaWidth; </pre><pre><span style=\"color:blue\">double</span> height = printDialog.PrintableAreaHeight; </pre><pre>Size size = <span style=\"color:blue\">new</span> Size( width - 100, height - 100); </pre><pre>Point point = <span style=\"color:blue\">new</span> Point((width - size.Width) * 0.5, (height - size.Height) * 0.5); </pre><pre>_plotter.Measure(size); </pre><pre>_plotter.Arrange(<span style=\"color:blue\">new</span> Rect(point, size)); </pre><pre>printDialog.PrintVisual(_plotter, <span style=\"color:#a31515\">&quot;chart&quot;</span>);</pre></div>\r\n<p>this does not work. the grid and 'Graph Lines' are not scaled right.</p>\r\n<p>so i need an example or en explonation how to do it right.</p>\r\n<p>thx.</p>\r\n<p>&nbsp;</p>\r\n<p>ps: this doesn't help: <a href=\"http://dynamicdatadisplay.codeplex.com/Thread/View.aspx?ThreadId=62813\">http://dynamicdatadisplay.codeplex.com/Thread/View.aspx?ThreadId=62813</a></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-08-17T03:13:45.767-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "481321",
    "ThreadId": "223793",
    "Html": "<p>I use this function to print D3 charts:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>\r\n<span style=\"color:blue\">using</span> System;\r\n<span style=\"color:blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:blue\">using</span> System.Linq;\r\n<span style=\"color:blue\">using</span> System.Text;\r\n<span style=\"color:blue\">using</span> System.Windows;\r\n<span style=\"color:blue\">using</span> System.Windows.Controls;\r\n<span style=\"color:blue\">using</span> System.Windows.Media;\r\n<span style=\"color:blue\">using</span> System.Globalization;\r\n<span style=\"color:blue\">using</span> System.Printing;\r\n\r\n<span style=\"color:blue\">namespace</span> Utilities\r\n{\r\n    <span style=\"color:blue\">static</span> <span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> PrintHelper\r\n    {\r\n        <span style=\"color:blue\">static</span> <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Print(FrameworkElement ele, <span style=\"color:blue\">string</span> name)\r\n        {\r\n            <span style=\"color:green\">//Most printers don't do borderless printing, so this artifically adds a border.</span>\r\n            <span style=\"color:blue\">const</span> <span style=\"color:blue\">double</span> margin = 30;\r\n            <span style=\"color:blue\">const</span> <span style=\"color:blue\">double</span> titlePadding = 10;\r\n\r\n            PrintDialog printDlg = <span style=\"color:blue\">new</span> PrintDialog();\r\n            printDlg.PrintTicket.PageOrientation = PageOrientation.Landscape;\r\n            <span style=\"color:blue\">if</span> (printDlg.ShowDialog() != <span style=\"color:blue\">true</span>) <span style=\"color:blue\">return</span>;\r\n\r\n            <span style=\"color:green\">//Format the title line</span>\r\n            FormattedText formattedText = <span style=\"color:blue\">new</span> FormattedText(name, CultureInfo.GetCultureInfo(<span style=\"color:#a31515\">&quot;en-us&quot;</span>), FlowDirection.LeftToRight, <span style=\"color:blue\">new</span> Typeface(<span style=\"color:#a31515\">&quot;Verdana&quot;</span>), 12, Brushes.Black);\r\n            formattedText.MaxTextWidth = printDlg.PrintableAreaWidth;\r\n\r\n            <span style=\"color:blue\">double</span> scale = Math.Min(printDlg.PrintableAreaWidth / (ele.ActualWidth + (margin * 2)), (printDlg.PrintableAreaHeight - (formattedText.Height + titlePadding)) / (ele.ActualHeight + (margin * 2)));\r\n\r\n            DrawingVisual visual = <span style=\"color:blue\">new</span> DrawingVisual();\r\n            <span style=\"color:blue\">using</span> (DrawingContext context = visual.RenderOpen())\r\n            {\r\n                VisualBrush brush = <span style=\"color:blue\">new</span> VisualBrush(ele);\r\n                context.DrawRectangle(brush, <span style=\"color:blue\">null</span>, <span style=\"color:blue\">new</span> Rect(<span style=\"color:blue\">new</span> Point(margin, margin + formattedText.Height + titlePadding), <span style=\"color:blue\">new</span> Size(ele.ActualWidth, ele.ActualHeight)));\r\n\r\n                context.DrawText(formattedText, <span style=\"color:blue\">new</span> Point(margin, margin));\r\n                context.DrawLine(<span style=\"color:blue\">new</span> Pen(Brushes.Black, 1), <span style=\"color:blue\">new</span> Point(margin, margin), <span style=\"color:blue\">new</span> Point(printDlg.PrintableAreaWidth - (2 * margin), margin));\r\n            }\r\n\r\n            visual.Transform = <span style=\"color:blue\">new</span> ScaleTransform(scale, scale);\r\n\r\n            printDlg.PrintVisual(visual, name);\r\n        }\r\n\r\n    }\r\n}\r\n\r\n</pre>\r\n</div>\r\n<p>Grant.</p>",
    "PostedDate": "2010-08-17T03:54:37.777-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "729915",
    "ThreadId": "223793",
    "Html": "<p>Grant, Thanks so much for that&nbsp;chunk of code, it&nbsp;saved me a ton of time!&nbsp;I just added the following XAML</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">Button</span> <span style=\"color: red;\">Content</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Print</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">Height</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">24</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">HorizontalAlignment</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Left</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">Margin</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">245,0,0,12</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">Name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">button1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">VerticalAlignment</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Bottom</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">Width</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">60</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">Click</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">bPrint_Click</span><span style=\"color: black;\">\"</span> <span style=\"color: blue;\">/&gt;</span><br /><br />a little&nbsp;C#</p>\r\n<p>&nbsp;﻿&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color: blue;\">private</span> <span style=\"color: blue;\">void</span> bPrint_Click(<span style=\"color: blue;\">object</span> sender, RoutedEventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PrintHelper.Print(grid, chartTitle.ToString());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />﻿﻿and I was printing charts! Now for a cup of coffee... :-)</p>",
    "PostedDate": "2012-01-24T06:07:56.917-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1108936",
    "ThreadId": "223793",
    "Html": "ydab_lj, grantz and mtimperley, \r<br />\n<br />\nThanks so much for asking and the code. It saved me a lot of time, too. Ichecked it out, tried it and the printed charts were wonderful!\r<br />\n<br />\nIs there any way to give You some benfits, likes or points or something else?\r<br />\n<br />\nOttilie<br />\n",
    "PostedDate": "2013-10-17T12:14:10.36-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]